"use strict";!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){var t=window.setInterval,a=function(e,a){var n=this,r=Array.prototype.slice.call(arguments,2);return t(e instanceof Function?function(){e.apply(n,r)}:e,a)};e.fn.ftakar=function(t){var n=e.extend(e.fn.ftakar.defaults,t),r=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}};if(r()){var o=e(this),i={get:function(){var e=JSON.parse(localStorage.getItem(n.savedDataName));return"object"==typeof e&&null!=e?e:{}},set:function(e){localStorage.setItem(n.savedDataName,JSON.stringify(e))},destroy:function(){localStorage.removeItem(n.savedDataName)}},s={create:function(t){for(var a=0;a<n.idAttribs.length;a++)if(null!=e(t).attr(n.idAttribs[a]))return escape(n.idAttribs[a])+"~"+escape(e(t).attr(n.idAttribs[a]));return!1},get:function(e){for(var t=e.split(/~(.+)?/),a=0;a<t.length;a++)t[a]=unescape(t[a]);return t}},c={save:function(t){if(t){var a=i.get(),r=s.create(t);if(r){n.beforeSave.call();var o=(new Date).getTime(),c=n.expireInMs?parseInt(o.toString())+n.expireInMs:null,l="";switch(e(t).attr("type")){case"radio":case"checkbox":l=e(t).prop("checked");break;case"select":case"input":default:l=e(t).val()}return a[r]={expires:c,val:l},i.set(a),n.onSave.call(),!0}}return!1},destroy:function(e){if(e){var t=i.get(),a=s.create(e);if(a)return n.beforeDelete.call(),delete t[a],n.onDelete.call(),i.set(t),!0}return!1},hasExpired:function(e){var t=(new Date).getTime();return e.expires?t>e.expires:!1}};n.clearOnSubmit&&this.closest("form").submit(function(e){e.preventDefault(),o.each(function(){c.destroy(this)})}),n.saveOnInterval&&!isNaN(n.saveOnInterval)&&parseInt(n.saveOnInterval)>0&&a(function(e){for(var t=0;t<e.length;t++)c.save(e[t])},parseInt(n.saveOnInterval),this),e(document).ready(function(){n.beforeLoad.call();var t=i.get();for(var a in t)if(c.hasExpired(t[a]))delete t[s];else{var r=s.get(a),o=e("["+r[0]+'="'+r[1]+'"]');switch(o.attr("type")){case"radio":case"checkbox":o.prop("checked",t[a].val);break;case"select":o.find("option").filter(function(){return e(this).text()==t[a].val}).attr("selected",!0);break;default:o.val(t[a].val)}}i.set(t),n.onLoad.call()}),n.saveOnChange&&this.change(function(){c.save(this)})}return this},e.fn.ftakar.defaults={savedDataName:"FTAKAR",saveOnInterval:!1,saveOnChange:!0,clearOnSubmit:!0,expireInMs:!1,idAttribs:["id","name","data-ftakar"],beforeSave:function(){console.info("FTAKAR: data is being saved",e(this))},onSave:function(){console.info("FTAKAR: data saved",e(this))},beforeLoad:function(){console.info("FTAKAR: data is being loaded")},onLoad:function(){console.info("FTAKAR: data has loaded")},beforeDelete:function(){console.info("FTAKAR: element data is going to be deleted",e(this))},onDelete:function(){console.info("FTAKAR: element data deleted",e(this))},beforeClear:function(){console.info("FTAKAR: data is going to be cleared")},onClear:function(){console.info("FTAKAR: data cleared")}}});